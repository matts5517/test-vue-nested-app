{"version":3,"sources":["webpack:///./node_modules/@arcgis/core/identity/IdentityForm.js","webpack:///./node_modules/focus-trap/dist/focus-trap.esm.js","webpack:///./node_modules/tabbable/dist/index.esm.js","webpack:///./node_modules/@arcgis/core/identity/IdentityModal.js","webpack:///./node_modules/@arcgis/core/identity/OAuthCredential.js","webpack:///./node_modules/@arcgis/core/identity/OAuthInfo.js","webpack:///./node_modules/@arcgis/core/identity/ServerInfo.js","webpack:///./node_modules/@arcgis/core/identity/IdentityManagerBase.js","webpack:///./node_modules/@arcgis/core/identity/IdentityManager.js"],"names":["base","group","label","footer","esriInput","esriButton","esriButtonSecondary","s","e","super","this","_usernameInputNode","_passwordInputNode","messages","signingIn","server","resource","error","oAuthPrompt","t","o","n","a","d","class","oAuthInfo","info","test","lblItem","c","key","lblUser","value","required","autocomplete","spellcheck","type","bind","afterCreate","m","lblPwd","h","classes","disabled","lblSigning","lblOk","lblCancel","onclick","_cancel","g","details","httpStatus","invalidUser","noAuthService","onsubmit","_submit","_set","emit","preventDefault","username","password","prototype","activeFocusDelay","candidateSelectors","candidateSelector","join","matches","Element","msMatchesSelector","webkitMatchesSelector","getCandidates","el","includeContainer","filter","candidates","Array","slice","apply","querySelectorAll","call","unshift","isContentEditable","node","contentEditable","getTabindex","tabindexAttr","parseInt","getAttribute","isNaN","nodeName","tabIndex","sortOrderedTabbables","b","documentOrder","isInput","tagName","isHiddenInput","isDetailsWithSummary","r","children","some","child","getCheckedRadio","nodes","form","i","length","checked","isTabbableRadio","name","radioSet","radioScope","ownerDocument","queryRadios","window","CSS","escape","err","console","message","isRadio","isNonTabbableRadio","isHidden","displayCheck","getComputedStyle","visibility","isDirectSummary","nodeUnderDetails","parentElement","_node$getBoundingClie","getBoundingClientRect","width","height","display","isNodeMatchingSelectorFocusable","options","isNodeMatchingSelectorTabbable","tabbable","regularTabbables","orderedTabbables","forEach","candidate","candidateTabindex","push","tabbableNodes","sort","map","concat","focusableCandidateSelector","isFocusable","Error","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","sym","getOwnPropertyDescriptor","enumerable","_objectSpread2","target","arguments","source","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","configurable","writable","activeFocusTraps","trapQueue","activateTrap","trap","activeTrap","pause","trapIndex","indexOf","splice","deactivateTrap","unpause","isSelectableInput","toLowerCase","select","isEscapeEvent","keyCode","isTabEvent","delay","fn","setTimeout","findIndex","arr","idx","every","valueOrHandler","_len","params","_key","elements","userOptions","doc","document","config","returnFocusOnDeactivate","escapeDeactivates","delayInitialFocus","state","containers","tabbableGroups","nodeFocusedBeforeActivation","mostRecentlyFocusedNode","active","paused","getOption","configOverrideOptions","optionName","configOptionName","undefined","containersContain","element","container","contains","getNodeForOption","optionValue","querySelector","getInitialFocusNode","activeElement","firstTabbableGroup","firstTabbableNode","updateTabbableNodes","lastTabbableNode","tryFocus","focus","preventScroll","getReturnFocusNode","previousActiveElement","checkPointerDown","clickOutsideDeactivates","deactivate","returnFocus","allowOutsideClick","checkFocusIn","targetContained","Document","stopImmediatePropagation","checkTab","destinationNode","containerIndex","_ref","shiftKey","startOfGroupIndex","_ref2","destinationGroupIndex","destinationGroup","lastOfGroupIndex","_ref3","_destinationGroupIndex","_destinationGroup","checkKey","checkClick","addListeners","addEventListener","capture","passive","removeListeners","removeEventListener","activate","activateOptions","onActivate","onPostActivate","checkCanFocusTrap","finishActivation","then","deactivateOptions","clearTimeout","onDeactivate","onPostDeactivate","checkCanReturnFocus","finishDeactivation","updateContainerElements","containerElements","elementsAsArray","Boolean","open","closed","title","dialog","content","closeButton","iconClose","createElement","_close","body","appendChild","own","watch","_toggleFocusTrap","_destroyFocusTrap","id","close","l","p","u","role","_createFocusTrap","_renderContent","_focusTrap","requestAnimationFrame","initialFocus","cancelAnimationFrame","innerHTML","render","HTMLElement","_attachToNode","readOnly","aliasOf","storage","appId","expires","ssl","token","userId","_init","Date","now","minTimeUntilExpiration","_load","authNamespace","portalUrl","setItem","JSON","stringify","log","replace","FormData","append","navigator","sendBeacon","XMLHttpRequest","send","_oAuthCred","getItem","parse","declaredClass","expiration","forceLogin","forceUserId","locale","popup","popupCallbackUrl","popupWindowFeatures","preserveUrlHash","fromJSON","toJSON","json","write","adminTokenServiceUrl","currentVersion","hasPortal","hasServer","owningSystemUrl","owningTenant","shortLivedTokenValidity","tokenServiceUrl","webTierAuth","R","host","P","C","D","localStorage","sessionStorage","_portalConfig","esriGeowConfig","serverInfos","oAuthInfos","credentials","_soReqs","_xoReqs","_portals","defaultOAuthInfo","defaultTokenValidity","formConstructor","tokenValidity","normalizeWebTierAuth","_appOrigin","origin","location","_appUrlObj","href","_busy","_rejectOnPersistedPageShow","_oAuthHash","_gwTokenUrl","_agsRest","_agsPortal","_agsAdmin","_adminSvcs","_gwDomains","regex","customBaseUrl","_legacyFed","_regexSDirUrl","_regexServerType","_gwUser","_gwItem","_gwGroup","_rePortalTokenSvc","_createDefaultOAuthInfo","_hasTestedIfAppIsOnPortal","_getOAuthHash","_pageShowHandler","findServerInfo","findOAuthInfo","_sanitizeUrl","_isServerRsrc","_getServerInstanceRoot","_getTokenSvcUrl","registerServers","_findCredential","assign","j","scope","resources","emitTokenChange","refreshServerTokens","registerOAuthInfos","_hasSameServerInstance","_getIdenticalSvcIdx","prompt","signal","abort","reject","promise","_isAdminResource","findCredential","_","destroy","f","resolve","_restInfoPms","_selfReq","selfDfd","_getPortalSelf","_enqueue","_isRESTService","isAdmin","serverUrl","customParameters","scheme","uri","port","v","query","request","referer","client","method","authMode","useProxy","_useProxy","ioArgs","withCredentials","data","validity","checkAppAccess","credential","getCredential","_doPortalSignIn","force","client_id","valid","viewOnlyUserTypeApp","catch","viewOnly","_oAuthDfd","clearInterval","_oAuthIntervalId","_oAuthOnHashHandle","remove","charAt","substring","error_description","sinfo_","oinfo_","access_token","Number","expires_in","persist","save","_oAuthRedirectFunc","_protocolFunc","getResourceName","on","generateToken","oAuthWin_","resUrl_","oAuthPopupConfirmation","_doOAuthSignIn","_postMessageAuthHandle","endsWith","postMessage","hash","hasOwnProperty","persisted","isBusy","_errbackFunc","_addResource","_removeResource","_isIdProvider","_isPortalDomain","String","search","substr","_normalizeAGOLorgDomain","proxyUrl","path","_getSuffix","restBaseUrl","_isIdenticalService","adminUrl","_getOrigin","headers","Promise","allSSL","portalMode","supportsOAuth","startsWith","trim","resourceUrl","serverInfo","options_","admin_","refresh_","_doSignIn","creationTime","shift","_findOAuthInfo","parent","isValid","_pendingDfd","_exchangeToken","oAuthState","oAuthSignIn","_getPlatformSelf","_checkProtocol","signIn","user","portalToken","tokenExpiration","parseFloat","_generateOAuthInfo","accountId","redirect_uri","clone","urlKey","top","response_type","force_login","prepopulatedusername","redirectToUserOrgUrl","setInterval","setOAuthResponseHash","detail","authorizeParams","authorizeUrl","EventedAccessor","tokenRefreshBuffer","_enqueued","refreshToken","_refreshTimer","_startRefreshTimer"],"mappings":"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","file":"js/chunk-771be51c.afd8b47f.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as s}from\"../chunks/tslib.es6.js\";import{property as e}from\"../core/accessorSupport/decorators/property.js\";import\"../core/has.js\";import\"../core/accessorSupport/ensureType.js\";import\"../core/Logger.js\";import{subclass as t}from\"../core/accessorSupport/decorators/subclass.js\";import{substitute as r}from\"../intl/substitute.js\";import o from\"../widgets/Widget.js\";import{storeNode as i}from\"../widgets/support/widgetUtils.js\";import{messageBundle as n}from\"../widgets/support/decorators/messageBundle.js\";import{tsx as u}from\"../widgets/support/jsxFactory.js\";const l={base:\"esri-identity-form\",group:\"esri-identity-form__group\",label:\"esri-identity-form__label\",footer:\"esri-identity-form__footer\",esriInput:\"esri-input\",esriButton:\"esri-button\",esriButtonSecondary:\"esri-button--secondary\"},p=\"ArcGIS Online\";let a=class extends o{constructor(s,e){super(s,e),this._usernameInputNode=null,this._passwordInputNode=null,this.messages=null,this.signingIn=!1,this.server=null,this.resource=null,this.error=null,this.oAuthPrompt=!1}render(){const{error:s,server:e,resource:t,signingIn:o,oAuthPrompt:n,messages:a}=this,d=u(\"div\",{class:l.group},r(n?a.oAuthInfo:a.info,{server:/\\.arcgis\\.com/i.test(e)?p:e,resource:`(${t||a.lblItem})`})),c=n?null:u(\"div\",{class:l.group,key:\"username\"},u(\"label\",{class:l.label},a.lblUser,u(\"input\",{value:\"\",required:!0,autocomplete:\"off\",spellcheck:!1,type:\"text\",bind:this,afterCreate:i,\"data-node-ref\":\"_usernameInputNode\",class:l.esriInput}))),m=n?null:u(\"div\",{class:l.group,key:\"password\"},u(\"label\",{class:l.label},a.lblPwd,u(\"input\",{value:\"\",required:!0,type:\"password\",bind:this,afterCreate:i,\"data-node-ref\":\"_passwordInputNode\",class:l.esriInput}))),h=u(\"div\",{class:this.classes(l.group,l.footer)},u(\"input\",{type:\"submit\",disabled:!!o,value:o?a.lblSigning:a.lblOk,class:l.esriButton}),u(\"input\",{type:\"button\",value:a.lblCancel,bind:this,onclick:this._cancel,class:this.classes(l.esriButton,l.esriButtonSecondary)})),g=s?u(\"div\",null,s.details&&s.details.httpStatus?a.invalidUser:a.noAuthService):null;return u(\"form\",{class:l.base,bind:this,onsubmit:this._submit},d,g,c,m,h)}_cancel(){this._set(\"signingIn\",!1),this._usernameInputNode&&(this._usernameInputNode.value=\"\"),this._passwordInputNode&&(this._passwordInputNode.value=\"\"),this.emit(\"cancel\")}_submit(s){s.preventDefault(),this._set(\"signingIn\",!0);const e=this.oAuthPrompt?{}:{username:this._usernameInputNode&&this._usernameInputNode.value,password:this._passwordInputNode&&this._passwordInputNode.value};this.emit(\"submit\",e)}};s([e(),n(\"esri/identity/t9n/identity\")],a.prototype,\"messages\",void 0),s([e()],a.prototype,\"signingIn\",void 0),s([e()],a.prototype,\"server\",void 0),s([e()],a.prototype,\"resource\",void 0),s([e()],a.prototype,\"error\",void 0),s([e()],a.prototype,\"oAuthPrompt\",void 0),a=s([t(\"esri.identity.IdentityForm\")],a);var d=a;export default d;\n","/*!\n* focus-trap 6.5.1\n* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE\n*/\nimport { tabbable, isFocusable } from 'tabbable';\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar activeFocusDelay;\n\nvar activeFocusTraps = function () {\n  var trapQueue = [];\n  return {\n    activateTrap: function activateTrap(trap) {\n      if (trapQueue.length > 0) {\n        var activeTrap = trapQueue[trapQueue.length - 1];\n\n        if (activeTrap !== trap) {\n          activeTrap.pause();\n        }\n      }\n\n      var trapIndex = trapQueue.indexOf(trap);\n\n      if (trapIndex === -1) {\n        trapQueue.push(trap);\n      } else {\n        // move this existing trap to the front of the queue\n        trapQueue.splice(trapIndex, 1);\n        trapQueue.push(trap);\n      }\n    },\n    deactivateTrap: function deactivateTrap(trap) {\n      var trapIndex = trapQueue.indexOf(trap);\n\n      if (trapIndex !== -1) {\n        trapQueue.splice(trapIndex, 1);\n      }\n\n      if (trapQueue.length > 0) {\n        trapQueue[trapQueue.length - 1].unpause();\n      }\n    }\n  };\n}();\n\nvar isSelectableInput = function isSelectableInput(node) {\n  return node.tagName && node.tagName.toLowerCase() === 'input' && typeof node.select === 'function';\n};\n\nvar isEscapeEvent = function isEscapeEvent(e) {\n  return e.key === 'Escape' || e.key === 'Esc' || e.keyCode === 27;\n};\n\nvar isTabEvent = function isTabEvent(e) {\n  return e.key === 'Tab' || e.keyCode === 9;\n};\n\nvar delay = function delay(fn) {\n  return setTimeout(fn, 0);\n}; // Array.find/findIndex() are not supported on IE; this replicates enough\n//  of Array.findIndex() for our needs\n\n\nvar findIndex = function findIndex(arr, fn) {\n  var idx = -1;\n  arr.every(function (value, i) {\n    if (fn(value)) {\n      idx = i;\n      return false; // break\n    }\n\n    return true; // next\n  });\n  return idx;\n};\n/**\n * Get an option's value when it could be a plain value, or a handler that provides\n *  the value.\n * @param {*} value Option's value to check.\n * @param {...*} [params] Any parameters to pass to the handler, if `value` is a function.\n * @returns {*} The `value`, or the handler's returned value.\n */\n\n\nvar valueOrHandler = function valueOrHandler(value) {\n  for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    params[_key - 1] = arguments[_key];\n  }\n\n  return typeof value === 'function' ? value.apply(void 0, params) : value;\n};\n\nvar createFocusTrap = function createFocusTrap(elements, userOptions) {\n  var doc = document;\n\n  var config = _objectSpread2({\n    returnFocusOnDeactivate: true,\n    escapeDeactivates: true,\n    delayInitialFocus: true\n  }, userOptions);\n\n  var state = {\n    // @type {Array<HTMLElement>}\n    containers: [],\n    // list of objects identifying the first and last tabbable nodes in all containers/groups in\n    //  the trap\n    // NOTE: it's possible that a group has no tabbable nodes if nodes get removed while the trap\n    //  is active, but the trap should never get to a state where there isn't at least one group\n    //  with at least one tabbable node in it (that would lead to an error condition that would\n    //  result in an error being thrown)\n    // @type {Array<{ container: HTMLElement, firstTabbableNode: HTMLElement|null, lastTabbableNode: HTMLElement|null }>}\n    tabbableGroups: [],\n    nodeFocusedBeforeActivation: null,\n    mostRecentlyFocusedNode: null,\n    active: false,\n    paused: false\n  };\n  var trap; // eslint-disable-line prefer-const -- some private functions reference it, and its methods reference private functions, so we must declare here and define later\n\n  var getOption = function getOption(configOverrideOptions, optionName, configOptionName) {\n    return configOverrideOptions && configOverrideOptions[optionName] !== undefined ? configOverrideOptions[optionName] : config[configOptionName || optionName];\n  };\n\n  var containersContain = function containersContain(element) {\n    return state.containers.some(function (container) {\n      return container.contains(element);\n    });\n  };\n\n  var getNodeForOption = function getNodeForOption(optionName) {\n    var optionValue = config[optionName];\n\n    if (!optionValue) {\n      return null;\n    }\n\n    var node = optionValue;\n\n    if (typeof optionValue === 'string') {\n      node = doc.querySelector(optionValue);\n\n      if (!node) {\n        throw new Error(\"`\".concat(optionName, \"` refers to no known node\"));\n      }\n    }\n\n    if (typeof optionValue === 'function') {\n      node = optionValue();\n\n      if (!node) {\n        throw new Error(\"`\".concat(optionName, \"` did not return a node\"));\n      }\n    }\n\n    return node;\n  };\n\n  var getInitialFocusNode = function getInitialFocusNode() {\n    var node;\n\n    if (getNodeForOption('initialFocus') !== null) {\n      node = getNodeForOption('initialFocus');\n    } else if (containersContain(doc.activeElement)) {\n      node = doc.activeElement;\n    } else {\n      var firstTabbableGroup = state.tabbableGroups[0];\n      var firstTabbableNode = firstTabbableGroup && firstTabbableGroup.firstTabbableNode;\n      node = firstTabbableNode || getNodeForOption('fallbackFocus');\n    }\n\n    if (!node) {\n      throw new Error('Your focus-trap needs to have at least one focusable element');\n    }\n\n    return node;\n  };\n\n  var updateTabbableNodes = function updateTabbableNodes() {\n    state.tabbableGroups = state.containers.map(function (container) {\n      var tabbableNodes = tabbable(container);\n\n      if (tabbableNodes.length > 0) {\n        return {\n          container: container,\n          firstTabbableNode: tabbableNodes[0],\n          lastTabbableNode: tabbableNodes[tabbableNodes.length - 1]\n        };\n      }\n\n      return undefined;\n    }).filter(function (group) {\n      return !!group;\n    }); // remove groups with no tabbable nodes\n    // throw if no groups have tabbable nodes and we don't have a fallback focus node either\n\n    if (state.tabbableGroups.length <= 0 && !getNodeForOption('fallbackFocus')) {\n      throw new Error('Your focus-trap must have at least one container with at least one tabbable node in it at all times');\n    }\n  };\n\n  var tryFocus = function tryFocus(node) {\n    if (node === doc.activeElement) {\n      return;\n    }\n\n    if (!node || !node.focus) {\n      tryFocus(getInitialFocusNode());\n      return;\n    }\n\n    node.focus({\n      preventScroll: !!config.preventScroll\n    });\n    state.mostRecentlyFocusedNode = node;\n\n    if (isSelectableInput(node)) {\n      node.select();\n    }\n  };\n\n  var getReturnFocusNode = function getReturnFocusNode(previousActiveElement) {\n    var node = getNodeForOption('setReturnFocus');\n    return node ? node : previousActiveElement;\n  }; // This needs to be done on mousedown and touchstart instead of click\n  // so that it precedes the focus event.\n\n\n  var checkPointerDown = function checkPointerDown(e) {\n    if (containersContain(e.target)) {\n      // allow the click since it ocurred inside the trap\n      return;\n    }\n\n    if (valueOrHandler(config.clickOutsideDeactivates, e)) {\n      // immediately deactivate the trap\n      trap.deactivate({\n        // if, on deactivation, we should return focus to the node originally-focused\n        //  when the trap was activated (or the configured `setReturnFocus` node),\n        //  then assume it's also OK to return focus to the outside node that was\n        //  just clicked, causing deactivation, as long as that node is focusable;\n        //  if it isn't focusable, then return focus to the original node focused\n        //  on activation (or the configured `setReturnFocus` node)\n        // NOTE: by setting `returnFocus: false`, deactivate() will do nothing,\n        //  which will result in the outside click setting focus to the node\n        //  that was clicked, whether it's focusable or not; by setting\n        //  `returnFocus: true`, we'll attempt to re-focus the node originally-focused\n        //  on activation (or the configured `setReturnFocus` node)\n        returnFocus: config.returnFocusOnDeactivate && !isFocusable(e.target)\n      });\n      return;\n    } // This is needed for mobile devices.\n    // (If we'll only let `click` events through,\n    // then on mobile they will be blocked anyways if `touchstart` is blocked.)\n\n\n    if (valueOrHandler(config.allowOutsideClick, e)) {\n      // allow the click outside the trap to take place\n      return;\n    } // otherwise, prevent the click\n\n\n    e.preventDefault();\n  }; // In case focus escapes the trap for some strange reason, pull it back in.\n\n\n  var checkFocusIn = function checkFocusIn(e) {\n    var targetContained = containersContain(e.target); // In Firefox when you Tab out of an iframe the Document is briefly focused.\n\n    if (targetContained || e.target instanceof Document) {\n      if (targetContained) {\n        state.mostRecentlyFocusedNode = e.target;\n      }\n    } else {\n      // escaped! pull it back in to where it just left\n      e.stopImmediatePropagation();\n      tryFocus(state.mostRecentlyFocusedNode || getInitialFocusNode());\n    }\n  }; // Hijack Tab events on the first and last focusable nodes of the trap,\n  // in order to prevent focus from escaping. If it escapes for even a\n  // moment it can end up scrolling the page and causing confusion so we\n  // kind of need to capture the action at the keydown phase.\n\n\n  var checkTab = function checkTab(e) {\n    updateTabbableNodes();\n    var destinationNode = null;\n\n    if (state.tabbableGroups.length > 0) {\n      // make sure the target is actually contained in a group\n      // NOTE: the target may also be the container itself if it's tabbable\n      //  with tabIndex='-1' and was given initial focus\n      var containerIndex = findIndex(state.tabbableGroups, function (_ref) {\n        var container = _ref.container;\n        return container.contains(e.target);\n      });\n\n      if (containerIndex < 0) {\n        // target not found in any group: quite possible focus has escaped the trap,\n        //  so bring it back in to...\n        if (e.shiftKey) {\n          // ...the last node in the last group\n          destinationNode = state.tabbableGroups[state.tabbableGroups.length - 1].lastTabbableNode;\n        } else {\n          // ...the first node in the first group\n          destinationNode = state.tabbableGroups[0].firstTabbableNode;\n        }\n      } else if (e.shiftKey) {\n        // REVERSE\n        // is the target the first tabbable node in a group?\n        var startOfGroupIndex = findIndex(state.tabbableGroups, function (_ref2) {\n          var firstTabbableNode = _ref2.firstTabbableNode;\n          return e.target === firstTabbableNode;\n        });\n\n        if (startOfGroupIndex < 0 && state.tabbableGroups[containerIndex].container === e.target) {\n          // an exception case where the target is the container itself, in which\n          //  case, we should handle shift+tab as if focus were on the container's\n          //  first tabbable node, and go to the last tabbable node of the LAST group\n          startOfGroupIndex = containerIndex;\n        }\n\n        if (startOfGroupIndex >= 0) {\n          // YES: then shift+tab should go to the last tabbable node in the\n          //  previous group (and wrap around to the last tabbable node of\n          //  the LAST group if it's the first tabbable node of the FIRST group)\n          var destinationGroupIndex = startOfGroupIndex === 0 ? state.tabbableGroups.length - 1 : startOfGroupIndex - 1;\n          var destinationGroup = state.tabbableGroups[destinationGroupIndex];\n          destinationNode = destinationGroup.lastTabbableNode;\n        }\n      } else {\n        // FORWARD\n        // is the target the last tabbable node in a group?\n        var lastOfGroupIndex = findIndex(state.tabbableGroups, function (_ref3) {\n          var lastTabbableNode = _ref3.lastTabbableNode;\n          return e.target === lastTabbableNode;\n        });\n\n        if (lastOfGroupIndex < 0 && state.tabbableGroups[containerIndex].container === e.target) {\n          // an exception case where the target is the container itself, in which\n          //  case, we should handle tab as if focus were on the container's\n          //  last tabbable node, and go to the first tabbable node of the FIRST group\n          lastOfGroupIndex = containerIndex;\n        }\n\n        if (lastOfGroupIndex >= 0) {\n          // YES: then tab should go to the first tabbable node in the next\n          //  group (and wrap around to the first tabbable node of the FIRST\n          //  group if it's the last tabbable node of the LAST group)\n          var _destinationGroupIndex = lastOfGroupIndex === state.tabbableGroups.length - 1 ? 0 : lastOfGroupIndex + 1;\n\n          var _destinationGroup = state.tabbableGroups[_destinationGroupIndex];\n          destinationNode = _destinationGroup.firstTabbableNode;\n        }\n      }\n    } else {\n      destinationNode = getNodeForOption('fallbackFocus');\n    }\n\n    if (destinationNode) {\n      e.preventDefault();\n      tryFocus(destinationNode);\n    } // else, let the browser take care of [shift+]tab and move the focus\n\n  };\n\n  var checkKey = function checkKey(e) {\n    if (config.escapeDeactivates !== false && isEscapeEvent(e)) {\n      e.preventDefault();\n      trap.deactivate();\n      return;\n    }\n\n    if (isTabEvent(e)) {\n      checkTab(e);\n      return;\n    }\n  };\n\n  var checkClick = function checkClick(e) {\n    if (valueOrHandler(config.clickOutsideDeactivates, e)) {\n      return;\n    }\n\n    if (containersContain(e.target)) {\n      return;\n    }\n\n    if (valueOrHandler(config.allowOutsideClick, e)) {\n      return;\n    }\n\n    e.preventDefault();\n    e.stopImmediatePropagation();\n  }; //\n  // EVENT LISTENERS\n  //\n\n\n  var addListeners = function addListeners() {\n    if (!state.active) {\n      return;\n    } // There can be only one listening focus trap at a time\n\n\n    activeFocusTraps.activateTrap(trap); // Delay ensures that the focused element doesn't capture the event\n    // that caused the focus trap activation.\n\n    activeFocusDelay = config.delayInitialFocus ? delay(function () {\n      tryFocus(getInitialFocusNode());\n    }) : tryFocus(getInitialFocusNode());\n    doc.addEventListener('focusin', checkFocusIn, true);\n    doc.addEventListener('mousedown', checkPointerDown, {\n      capture: true,\n      passive: false\n    });\n    doc.addEventListener('touchstart', checkPointerDown, {\n      capture: true,\n      passive: false\n    });\n    doc.addEventListener('click', checkClick, {\n      capture: true,\n      passive: false\n    });\n    doc.addEventListener('keydown', checkKey, {\n      capture: true,\n      passive: false\n    });\n    return trap;\n  };\n\n  var removeListeners = function removeListeners() {\n    if (!state.active) {\n      return;\n    }\n\n    doc.removeEventListener('focusin', checkFocusIn, true);\n    doc.removeEventListener('mousedown', checkPointerDown, true);\n    doc.removeEventListener('touchstart', checkPointerDown, true);\n    doc.removeEventListener('click', checkClick, true);\n    doc.removeEventListener('keydown', checkKey, true);\n    return trap;\n  }; //\n  // TRAP DEFINITION\n  //\n\n\n  trap = {\n    activate: function activate(activateOptions) {\n      if (state.active) {\n        return this;\n      }\n\n      var onActivate = getOption(activateOptions, 'onActivate');\n      var onPostActivate = getOption(activateOptions, 'onPostActivate');\n      var checkCanFocusTrap = getOption(activateOptions, 'checkCanFocusTrap');\n\n      if (!checkCanFocusTrap) {\n        updateTabbableNodes();\n      }\n\n      state.active = true;\n      state.paused = false;\n      state.nodeFocusedBeforeActivation = doc.activeElement;\n\n      if (onActivate) {\n        onActivate();\n      }\n\n      var finishActivation = function finishActivation() {\n        if (checkCanFocusTrap) {\n          updateTabbableNodes();\n        }\n\n        addListeners();\n\n        if (onPostActivate) {\n          onPostActivate();\n        }\n      };\n\n      if (checkCanFocusTrap) {\n        checkCanFocusTrap(state.containers.concat()).then(finishActivation, finishActivation);\n        return this;\n      }\n\n      finishActivation();\n      return this;\n    },\n    deactivate: function deactivate(deactivateOptions) {\n      if (!state.active) {\n        return this;\n      }\n\n      clearTimeout(activeFocusDelay);\n      removeListeners();\n      state.active = false;\n      state.paused = false;\n      activeFocusTraps.deactivateTrap(trap);\n      var onDeactivate = getOption(deactivateOptions, 'onDeactivate');\n      var onPostDeactivate = getOption(deactivateOptions, 'onPostDeactivate');\n      var checkCanReturnFocus = getOption(deactivateOptions, 'checkCanReturnFocus');\n\n      if (onDeactivate) {\n        onDeactivate();\n      }\n\n      var returnFocus = getOption(deactivateOptions, 'returnFocus', 'returnFocusOnDeactivate');\n\n      var finishDeactivation = function finishDeactivation() {\n        delay(function () {\n          if (returnFocus) {\n            tryFocus(getReturnFocusNode(state.nodeFocusedBeforeActivation));\n          }\n\n          if (onPostDeactivate) {\n            onPostDeactivate();\n          }\n        });\n      };\n\n      if (returnFocus && checkCanReturnFocus) {\n        checkCanReturnFocus(getReturnFocusNode(state.nodeFocusedBeforeActivation)).then(finishDeactivation, finishDeactivation);\n        return this;\n      }\n\n      finishDeactivation();\n      return this;\n    },\n    pause: function pause() {\n      if (state.paused || !state.active) {\n        return this;\n      }\n\n      state.paused = true;\n      removeListeners();\n      return this;\n    },\n    unpause: function unpause() {\n      if (!state.paused || !state.active) {\n        return this;\n      }\n\n      state.paused = false;\n      updateTabbableNodes();\n      addListeners();\n      return this;\n    },\n    updateContainerElements: function updateContainerElements(containerElements) {\n      var elementsAsArray = [].concat(containerElements).filter(Boolean);\n      state.containers = elementsAsArray.map(function (element) {\n        return typeof element === 'string' ? doc.querySelector(element) : element;\n      });\n\n      if (state.active) {\n        updateTabbableNodes();\n      }\n\n      return this;\n    }\n  }; // initialize container elements\n\n  trap.updateContainerElements(elements);\n  return trap;\n};\n\nexport { createFocusTrap };\n//# sourceMappingURL=focus-trap.esm.js.map\n","/*!\n* tabbable 5.2.0\n* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE\n*/\nvar candidateSelectors = ['input', 'select', 'textarea', 'a[href]', 'button', '[tabindex]', 'audio[controls]', 'video[controls]', '[contenteditable]:not([contenteditable=\"false\"])', 'details>summary:first-of-type', 'details'];\nvar candidateSelector = /* #__PURE__ */candidateSelectors.join(',');\nvar matches = typeof Element === 'undefined' ? function () {} : Element.prototype.matches || Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;\n\nvar getCandidates = function getCandidates(el, includeContainer, filter) {\n  var candidates = Array.prototype.slice.apply(el.querySelectorAll(candidateSelector));\n\n  if (includeContainer && matches.call(el, candidateSelector)) {\n    candidates.unshift(el);\n  }\n\n  candidates = candidates.filter(filter);\n  return candidates;\n};\n\nvar isContentEditable = function isContentEditable(node) {\n  return node.contentEditable === 'true';\n};\n\nvar getTabindex = function getTabindex(node) {\n  var tabindexAttr = parseInt(node.getAttribute('tabindex'), 10);\n\n  if (!isNaN(tabindexAttr)) {\n    return tabindexAttr;\n  } // Browsers do not return `tabIndex` correctly for contentEditable nodes;\n  // so if they don't have a tabindex attribute specifically set, assume it's 0.\n\n\n  if (isContentEditable(node)) {\n    return 0;\n  } // in Chrome, <details/>, <audio controls/> and <video controls/> elements get a default\n  //  `tabIndex` of -1 when the 'tabindex' attribute isn't specified in the DOM,\n  //  yet they are still part of the regular tab order; in FF, they get a default\n  //  `tabIndex` of 0; since Chrome still puts those elements in the regular tab\n  //  order, consider their tab index to be 0.\n\n\n  if ((node.nodeName === 'AUDIO' || node.nodeName === 'VIDEO' || node.nodeName === 'DETAILS') && node.getAttribute('tabindex') === null) {\n    return 0;\n  }\n\n  return node.tabIndex;\n};\n\nvar sortOrderedTabbables = function sortOrderedTabbables(a, b) {\n  return a.tabIndex === b.tabIndex ? a.documentOrder - b.documentOrder : a.tabIndex - b.tabIndex;\n};\n\nvar isInput = function isInput(node) {\n  return node.tagName === 'INPUT';\n};\n\nvar isHiddenInput = function isHiddenInput(node) {\n  return isInput(node) && node.type === 'hidden';\n};\n\nvar isDetailsWithSummary = function isDetailsWithSummary(node) {\n  var r = node.tagName === 'DETAILS' && Array.prototype.slice.apply(node.children).some(function (child) {\n    return child.tagName === 'SUMMARY';\n  });\n  return r;\n};\n\nvar getCheckedRadio = function getCheckedRadio(nodes, form) {\n  for (var i = 0; i < nodes.length; i++) {\n    if (nodes[i].checked && nodes[i].form === form) {\n      return nodes[i];\n    }\n  }\n};\n\nvar isTabbableRadio = function isTabbableRadio(node) {\n  if (!node.name) {\n    return true;\n  }\n\n  var radioScope = node.form || node.ownerDocument;\n\n  var queryRadios = function queryRadios(name) {\n    return radioScope.querySelectorAll('input[type=\"radio\"][name=\"' + name + '\"]');\n  };\n\n  var radioSet;\n\n  if (typeof window !== 'undefined' && typeof window.CSS !== 'undefined' && typeof window.CSS.escape === 'function') {\n    radioSet = queryRadios(window.CSS.escape(node.name));\n  } else {\n    try {\n      radioSet = queryRadios(node.name);\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.error('Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s', err.message);\n      return false;\n    }\n  }\n\n  var checked = getCheckedRadio(radioSet, node.form);\n  return !checked || checked === node;\n};\n\nvar isRadio = function isRadio(node) {\n  return isInput(node) && node.type === 'radio';\n};\n\nvar isNonTabbableRadio = function isNonTabbableRadio(node) {\n  return isRadio(node) && !isTabbableRadio(node);\n};\n\nvar isHidden = function isHidden(node, displayCheck) {\n  if (getComputedStyle(node).visibility === 'hidden') {\n    return true;\n  }\n\n  var isDirectSummary = matches.call(node, 'details>summary:first-of-type');\n  var nodeUnderDetails = isDirectSummary ? node.parentElement : node;\n\n  if (matches.call(nodeUnderDetails, 'details:not([open]) *')) {\n    return true;\n  }\n\n  if (!displayCheck || displayCheck === 'full') {\n    while (node) {\n      if (getComputedStyle(node).display === 'none') {\n        return true;\n      }\n\n      node = node.parentElement;\n    }\n  } else if (displayCheck === 'non-zero-area') {\n    var _node$getBoundingClie = node.getBoundingClientRect(),\n        width = _node$getBoundingClie.width,\n        height = _node$getBoundingClie.height;\n\n    return width === 0 && height === 0;\n  }\n\n  return false;\n};\n\nvar isNodeMatchingSelectorFocusable = function isNodeMatchingSelectorFocusable(options, node) {\n  if (node.disabled || isHiddenInput(node) || isHidden(node, options.displayCheck) ||\n  /* For a details element with a summary, the summary element gets the focused  */\n  isDetailsWithSummary(node)) {\n    return false;\n  }\n\n  return true;\n};\n\nvar isNodeMatchingSelectorTabbable = function isNodeMatchingSelectorTabbable(options, node) {\n  if (!isNodeMatchingSelectorFocusable(options, node) || isNonTabbableRadio(node) || getTabindex(node) < 0) {\n    return false;\n  }\n\n  return true;\n};\n\nvar tabbable = function tabbable(el, options) {\n  options = options || {};\n  var regularTabbables = [];\n  var orderedTabbables = [];\n  var candidates = getCandidates(el, options.includeContainer, isNodeMatchingSelectorTabbable.bind(null, options));\n  candidates.forEach(function (candidate, i) {\n    var candidateTabindex = getTabindex(candidate);\n\n    if (candidateTabindex === 0) {\n      regularTabbables.push(candidate);\n    } else {\n      orderedTabbables.push({\n        documentOrder: i,\n        tabIndex: candidateTabindex,\n        node: candidate\n      });\n    }\n  });\n  var tabbableNodes = orderedTabbables.sort(sortOrderedTabbables).map(function (a) {\n    return a.node;\n  }).concat(regularTabbables);\n  return tabbableNodes;\n};\n\nvar focusable = function focusable(el, options) {\n  options = options || {};\n  var candidates = getCandidates(el, options.includeContainer, isNodeMatchingSelectorFocusable.bind(null, options));\n  return candidates;\n};\n\nvar isTabbable = function isTabbable(node, options) {\n  options = options || {};\n\n  if (!node) {\n    throw new Error('No node provided');\n  }\n\n  if (matches.call(node, candidateSelector) === false) {\n    return false;\n  }\n\n  return isNodeMatchingSelectorTabbable(options, node);\n};\n\nvar focusableCandidateSelector = /* #__PURE__ */candidateSelectors.concat('iframe').join(',');\n\nvar isFocusable = function isFocusable(node, options) {\n  options = options || {};\n\n  if (!node) {\n    throw new Error('No node provided');\n  }\n\n  if (matches.call(node, focusableCandidateSelector) === false) {\n    return false;\n  }\n\n  return isNodeMatchingSelectorFocusable(options, node);\n};\n\nexport { focusable, isFocusable, isTabbable, tabbable };\n//# sourceMappingURL=index.esm.js.map\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../chunks/tslib.es6.js\";import{makeHandle as e}from\"../core/handleUtils.js\";import{property as o}from\"../core/accessorSupport/decorators/property.js\";import\"../core/has.js\";import\"../core/accessorSupport/ensureType.js\";import\"../core/Logger.js\";import{subclass as s}from\"../core/accessorSupport/decorators/subclass.js\";import i from\"../widgets/Widget.js\";import{isWidget as r}from\"../widgets/support/widget.js\";import{createFocusTrap as n}from\"focus-trap\";import{tsx as a}from\"../widgets/support/jsxFactory.js\";import{messageBundle as c}from\"../widgets/support/decorators/messageBundle.js\";const d={base:\"esri-identity-modal\",open:\"esri-identity-modal--open\",closed:\"esri-identity-modal--closed\",title:\"esri-identity-modal__title\",dialog:\"esri-identity-modal__dialog\",content:\"esri-identity-modal__content\",closeButton:\"esri-identity-modal__close-button\",iconClose:\"esri-icon-close\"};let l=class extends i{constructor(t,e){super(t,e),this.container=document.createElement(\"div\"),this.content=null,this.open=!1,this._close=()=>{this.open=!1},document.body.appendChild(this.container),this.own(this.watch(\"open\",(()=>this._toggleFocusTrap())))}destroy(){this._destroyFocusTrap()}render(){const t=this.id,{open:e,content:o,title:s,messages:i}=this,r=e&&!!o,n={[d.open]:r,[d.closed]:!r},c=a(\"button\",{class:d.closeButton,\"aria-label\":i.close,title:i.close,bind:this,onclick:this._close},a(\"span\",{\"aria-hidden\":\"true\",class:d.iconClose})),l=`${t}_title`,p=`${t}_content`,u=s?a(\"h1\",{id:l,class:d.title},s):null,m=r?a(\"div\",{bind:this,class:d.dialog,role:\"dialog\",\"aria-labelledby\":l,\"aria-describedby\":p,afterCreate:this._createFocusTrap},c,u,this._renderContent(p)):null;return a(\"div\",{tabIndex:-1,class:this.classes(d.base,n)},m)}_destroyFocusTrap(){var t;null==(t=this._focusTrap)||t.deactivate({onDeactivate:null}),this._focusTrap=null}_toggleFocusTrap(){const{_focusTrap:t,open:e}=this;t&&(e?t.activate():t.deactivate())}_createFocusTrap(t){this._destroyFocusTrap();const o=requestAnimationFrame((()=>{this._focusTrap=n(t,{initialFocus:\"input\",onDeactivate:this._close}),this._toggleFocusTrap()}));this.own(e((()=>cancelAnimationFrame(o))))}_renderContent(t){const e=this.content;return\"string\"==typeof e?a(\"div\",{class:d.content,id:t,innerHTML:e}):r(e)?a(\"div\",{class:d.content,id:t},e.render()):e instanceof HTMLElement?a(\"div\",{class:d.content,id:t,bind:e,afterCreate:this._attachToNode}):null}_attachToNode(t){const e=this;t.appendChild(e)}};t([o({readOnly:!0})],l.prototype,\"container\",void 0),t([o()],l.prototype,\"content\",void 0),t([o()],l.prototype,\"open\",void 0),t([o(),c(\"esri/t9n/common\")],l.prototype,\"messages\",void 0),t([o({aliasOf:\"messages.auth.signIn\"})],l.prototype,\"title\",void 0),l=t([s(\"esri.identity.IdentityModal\")],l);var p=l;export default p;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nconst t=\"esriJSAPIOAuth\";class s{constructor(t,s){this.oAuthInfo=null,this.storage=null,this.appId=null,this.expires=null,this.ssl=null,this.token=null,this.userId=null,this.oAuthInfo=t,this.storage=s,this._init()}isValid(){let t=!1;if(this.oAuthInfo&&this.token&&this.userId){const s=Date.now();if(this.expires>s){(this.expires-s)/1e3>60*this.oAuthInfo.minTimeUntilExpiration&&(t=!0)}}return t}save(){if(!this.storage)return;const s=this._load(),e=this.oAuthInfo;if(e&&e.authNamespace&&e.portalUrl){let o=s[e.authNamespace];o||(o=s[e.authNamespace]={}),o[e.portalUrl]={appId:this.appId=e.appId,expires:this.expires,ssl:this.ssl,token:this.token,userId:this.userId};try{this.storage.setItem(t,JSON.stringify(s))}catch(i){console.log(i)}}}destroy(){const s=this._load(),e=this.oAuthInfo;if(e&&e.appId&&e.portalUrl&&this.token&&this.expires>Date.now()){const t=e.portalUrl.replace(/^http:/i,\"https:\")+\"/sharing/rest/oauth2/revokeToken\",s=new FormData;if(s.append(\"f\",\"json\"),s.append(\"auth_token\",this.token),s.append(\"client_id\",e.appId),s.append(\"token_type_hint\",\"access_token\"),\"function\"==typeof navigator.sendBeacon)navigator.sendBeacon(t,s);else{const e=new XMLHttpRequest;e.open(\"POST\",t),e.send(s)}}if(e&&e.authNamespace&&e.portalUrl&&this.storage){const o=s[e.authNamespace];if(o){delete o[e.portalUrl];try{this.storage.setItem(t,JSON.stringify(s))}catch(i){console.log(i)}}}e&&(e._oAuthCred=null,this.oAuthInfo=null)}_init(){const t=this._load(),s=this.oAuthInfo;if(s&&s.authNamespace&&s.portalUrl){let e=t[s.authNamespace];e&&(e=e[s.portalUrl],e&&(this.appId=e.appId,this.expires=e.expires,this.ssl=e.ssl,this.token=e.token,this.userId=e.userId))}}_load(){let s={};if(this.storage){const i=this.storage.getItem(t);if(i)try{s=JSON.parse(i)}catch(e){console.log(e)}}return s}}s.prototype.declaredClass=\"esri.identity.OAuthCredential\";export default s;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../chunks/tslib.es6.js\";import{JSONSupport as t}from\"../core/JSONSupport.js\";import{property as r}from\"../core/accessorSupport/decorators/property.js\";import\"../core/has.js\";import\"../core/accessorSupport/ensureType.js\";import\"../core/Logger.js\";import{subclass as e}from\"../core/accessorSupport/decorators/subclass.js\";var p;let s=p=class extends t{constructor(o){super(o),this._oAuthCred=null,this.appId=null,this.authNamespace=\"/\",this.expiration=20160,this.forceLogin=!1,this.forceUserId=!1,this.locale=null,this.minTimeUntilExpiration=30,this.popup=!1,this.popupCallbackUrl=\"oauth-callback.html\",this.popupWindowFeatures=\"height=490,width=800,resizable,scrollbars,status\",this.portalUrl=\"https://www.arcgis.com\",this.preserveUrlHash=!1,this.userId=null}clone(){return p.fromJSON(this.toJSON())}};o([r({json:{write:!0}})],s.prototype,\"appId\",void 0),o([r({json:{write:!0}})],s.prototype,\"authNamespace\",void 0),o([r({json:{write:!0}})],s.prototype,\"expiration\",void 0),o([r({json:{write:!0}})],s.prototype,\"forceLogin\",void 0),o([r({json:{write:!0}})],s.prototype,\"forceUserId\",void 0),o([r({json:{write:!0}})],s.prototype,\"locale\",void 0),o([r({json:{write:!0}})],s.prototype,\"minTimeUntilExpiration\",void 0),o([r({json:{write:!0}})],s.prototype,\"popup\",void 0),o([r({json:{write:!0}})],s.prototype,\"popupCallbackUrl\",void 0),o([r({json:{write:!0}})],s.prototype,\"popupWindowFeatures\",void 0),o([r({json:{write:!0}})],s.prototype,\"portalUrl\",void 0),o([r({json:{write:!0}})],s.prototype,\"preserveUrlHash\",void 0),o([r({json:{write:!0}})],s.prototype,\"userId\",void 0),s=p=o([e(\"esri.identity.OAuthInfo\")],s);var i=s;export default i;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../chunks/tslib.es6.js\";import{JSONSupport as r}from\"../core/JSONSupport.js\";import{property as e}from\"../core/accessorSupport/decorators/property.js\";import\"../core/has.js\";import\"../core/accessorSupport/ensureType.js\";import\"../core/Logger.js\";import{subclass as t}from\"../core/accessorSupport/decorators/subclass.js\";let s=class extends r{constructor(o){super(o),this.adminTokenServiceUrl=null,this.currentVersion=null,this.hasPortal=null,this.hasServer=null,this.owningSystemUrl=null,this.owningTenant=null,this.server=null,this.shortLivedTokenValidity=null,this.tokenServiceUrl=null,this.webTierAuth=null}};o([e({json:{write:!0}})],s.prototype,\"adminTokenServiceUrl\",void 0),o([e({json:{write:!0}})],s.prototype,\"currentVersion\",void 0),o([e({json:{write:!0}})],s.prototype,\"hasPortal\",void 0),o([e({json:{write:!0}})],s.prototype,\"hasServer\",void 0),o([e({json:{write:!0}})],s.prototype,\"owningSystemUrl\",void 0),o([e({json:{write:!0}})],s.prototype,\"owningTenant\",void 0),o([e({json:{write:!0}})],s.prototype,\"server\",void 0),o([e({json:{write:!0}})],s.prototype,\"shortLivedTokenValidity\",void 0),o([e({json:{write:!0}})],s.prototype,\"tokenServiceUrl\",void 0),o([e({json:{write:!0}})],s.prototype,\"webTierAuth\",void 0),s=o([t(\"esri.identity.ServerInfo\")],s);var i=s;export default i;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import t from\"../config.js\";import{id as s}from\"../kernel.js\";import r from\"../request.js\";import i from\"../core/Error.js\";import n from\"../core/Evented.js\";import{on as o}from\"../core/events.js\";import a from\"../core/global.js\";import{fixJson as h}from\"../core/lang.js\";import{getDeepValue as l}from\"../core/object.js\";import{createAbortController as c,createResolver as d,onAbort as u,isAborted as p}from\"../core/promiseUtils.js\";import{urlToObject as _,hasSameOrigin as g,Url as f,queryToObject as m,normalize as v,getProxyRule as S,makeAbsolute as w,objectToQuery as I}from\"../core/urlUtils.js\";import{property as k}from\"../core/accessorSupport/decorators/property.js\";import\"../core/accessorSupport/ensureType.js\";import\"../core/has.js\";import\"../core/Logger.js\";import{subclass as A}from\"../core/accessorSupport/decorators/subclass.js\";import y from\"./IdentityForm.js\";import U from\"./IdentityModal.js\";import T from\"./OAuthCredential.js\";import x from\"./OAuthInfo.js\";import O from\"./ServerInfo.js\";const R={},b=e=>{const t=new f(e.owningSystemUrl).host,s=new f(e.server).host,r=/.+\\.arcgis\\.com$/i;return r.test(t)&&r.test(s)},P=(e,t)=>!!(b(e)&&t&&t.some((t=>t.test(e.server))));let C=null,D=null;try{C=window.localStorage,D=window.sessionStorage}catch{}class q extends n{constructor(){super(),this._portalConfig=a.esriGeowConfig,this.serverInfos=[],this.oAuthInfos=[],this.credentials=[],this._soReqs=[],this._xoReqs=[],this._portals=[],this.defaultOAuthInfo=null,this.defaultTokenValidity=60,this.dialog=null,this.formConstructor=y,this.tokenValidity=null,this.normalizeWebTierAuth=!1,this._appOrigin=\"null\"!==window.origin?window.origin:window.location.origin,this._appUrlObj=_(window.location.href),this._busy=null,this._rejectOnPersistedPageShow=!1,this._oAuthHash=null,this._gwTokenUrl=\"/sharing/rest/generateToken\",this._agsRest=\"/rest/services\",this._agsPortal=/\\/sharing(\\/|$)/i,this._agsAdmin=/(https?:\\/\\/[^\\/]+\\/[^\\/]+)\\/admin\\/?(\\/.*)?$/i,this._adminSvcs=/\\/rest\\/admin\\/services(\\/|$)/i,this._gwDomains=[{regex:/^https?:\\/\\/www\\.arcgis\\.com/i,customBaseUrl:\"maps.arcgis.com\",tokenServiceUrl:\"https://www.arcgis.com/sharing/rest/generateToken\"},{regex:/^https?:\\/\\/(?:dev|[a-z\\d-]+\\.mapsdev)\\.arcgis\\.com/i,customBaseUrl:\"mapsdev.arcgis.com\",tokenServiceUrl:\"https://dev.arcgis.com/sharing/rest/generateToken\"},{regex:/^https?:\\/\\/(?:devext|[a-z\\d-]+\\.mapsdevext)\\.arcgis\\.com/i,customBaseUrl:\"mapsdevext.arcgis.com\",tokenServiceUrl:\"https://devext.arcgis.com/sharing/rest/generateToken\"},{regex:/^https?:\\/\\/(?:qaext|[a-z\\d-]+\\.mapsqa)\\.arcgis\\.com/i,customBaseUrl:\"mapsqa.arcgis.com\",tokenServiceUrl:\"https://qaext.arcgis.com/sharing/rest/generateToken\"},{regex:/^https?:\\/\\/[a-z\\d-]+\\.maps\\.arcgis\\.com/i,customBaseUrl:\"maps.arcgis.com\",tokenServiceUrl:\"https://www.arcgis.com/sharing/rest/generateToken\"}],this._legacyFed=[],this._regexSDirUrl=/http.+\\/rest\\/services\\/?/gi,this._regexServerType=/(\\/(FeatureServer|GPServer|GeoDataServer|GeocodeServer|GeoenrichmentServer|GeometryServer|GlobeServer|ImageServer|MapServer|MobileServer|NAServer|NetworkDiagramServer|OGCFeatureServer|ParcelFabricServer|RelationalCatalogServer|SceneServer|StreamServer|UtilityNetworkServer|ValidationServer|VectorTileServer|VersionManagementServer)).*/gi,this._gwUser=/http.+\\/users\\/([^\\/]+)\\/?.*/i,this._gwItem=/http.+\\/items\\/([^\\/]+)\\/?.*/i,this._gwGroup=/http.+\\/groups\\/([^\\/]+)\\/?.*/i,this._rePortalTokenSvc=/\\/sharing(\\/rest)?\\/generatetoken/i,this._createDefaultOAuthInfo=!0,this._hasTestedIfAppIsOnPortal=!1,this._getOAuthHash(),window.addEventListener(\"pageshow\",(e=>{this._pageShowHandler(e)}))}registerServers(e){const t=this.serverInfos;t?(e=e.filter((e=>!this.findServerInfo(e.server))),this.serverInfos=t.concat(e)):this.serverInfos=e,e.forEach((e=>{e.owningSystemUrl&&this._portals.push(e.owningSystemUrl),e.hasPortal&&this._portals.push(e.server)}))}registerOAuthInfos(e){const t=this.oAuthInfos;if(t){for(const s of e){const e=this.findOAuthInfo(s.portalUrl);e&&t.splice(t.indexOf(e),1)}this.oAuthInfos=t.concat(e)}else this.oAuthInfos=e}registerToken(e){e={...e};const t=this._sanitizeUrl(e.server),s=this._isServerRsrc(t);let r,i=this.findServerInfo(t),n=!0;i||(i=new O,i.server=this._getServerInstanceRoot(t),s?i.hasServer=!0:(i.tokenServiceUrl=this._getTokenSvcUrl(t),i.hasPortal=!0),this.registerServers([i])),r=this._findCredential(t),r?(delete e.server,Object.assign(r,e),n=!1):(r=new j({userId:e.userId,server:i.server,token:e.token,expires:e.expires,ssl:e.ssl,scope:s?\"server\":\"portal\"}),r.resources=[t],this.credentials.push(r)),r.emitTokenChange(!1),n||r.refreshServerTokens()}toJSON(){return h({serverInfos:this.serverInfos.map((e=>e.toJSON())),oAuthInfos:this.oAuthInfos.map((e=>e.toJSON())),credentials:this.credentials.map((e=>e.toJSON()))})}initialize(e){if(!e)return;\"string\"==typeof e&&(e=JSON.parse(e));const t=e.serverInfos,s=e.oAuthInfos,r=e.credentials;if(t){const e=[];t.forEach((t=>{t.server&&t.tokenServiceUrl&&e.push(t.declaredClass?t:new O(t))})),e.length&&this.registerServers(e)}if(s){const e=[];s.forEach((t=>{t.appId&&e.push(t.declaredClass?t:new x(t))})),e.length&&this.registerOAuthInfos(e)}r&&r.forEach((e=>{e.server&&e.token&&e.expires&&e.expires>Date.now()&&((e=e.declaredClass?e:new j(e)).emitTokenChange(),this.credentials.push(e))}))}findServerInfo(e){let t;e=this._sanitizeUrl(e);for(const s of this.serverInfos)if(this._hasSameServerInstance(s.server,e)){t=s;break}return t}findOAuthInfo(e){let t;e=this._sanitizeUrl(e);for(const s of this.oAuthInfos)if(this._hasSameServerInstance(s.portalUrl,e)){t=s;break}return t}findCredential(e,t){let s;e=this._sanitizeUrl(e);const r=this._isServerRsrc(e)?\"server\":\"portal\";if(t){for(const i of this.credentials)if(this._hasSameServerInstance(i.server,e)&&t===i.userId&&i.scope===r){s=i;break}}else for(const i of this.credentials)if(this._hasSameServerInstance(i.server,e)&&-1!==this._getIdenticalSvcIdx(e,i)&&i.scope===r){s=i;break}return s}getCredential(e,t){let s,r,n=!0;t&&(s=!!t.token,r=t.error,n=!1!==t.prompt),t={...t},e=this._sanitizeUrl(e);const o=c(),a=d();if(t.signal&&u(t.signal,(()=>{o.abort()})),u(o,(()=>{a.reject(new i(\"identity-manager:user-aborted\",\"ABORTED\"))})),p(o))return a.promise;t.signal=o.signal;const h=this._isAdminResource(e),l=s?this.findCredential(e):null;let _;if(l&&r&&r.details&&498===r.details.httpStatus)l.destroy();else if(l)return _=new i(\"identity-manager:not-authorized\",\"You are currently signed in as: '\"+l.userId+\"'. You do not have access to this resource: \"+e,{error:r}),a.reject(_),a.promise;const f=this._findCredential(e,t);if(f)return a.resolve(f),a.promise;let m=this.findServerInfo(e);if(m)!m.hasServer&&this._isServerRsrc(e)&&(m._restInfoPms=this._getTokenSvcUrl(e),m.hasServer=!0);else{const t=this._getTokenSvcUrl(e);if(!t)return _=new i(\"identity-manager:unknown-resource\",\"Unknown resource - could not find token service endpoint.\"),a.reject(_),a.promise;m=new O,m.server=this._getServerInstanceRoot(e),\"string\"==typeof t?(m.tokenServiceUrl=t,m.hasPortal=!0):(m._restInfoPms=t,m.hasServer=!0),this.registerServers([m])}return m.hasPortal&&void 0===m._selfReq&&(n||g(m.tokenServiceUrl,this._appOrigin)||this._gwDomains.some((e=>e.tokenServiceUrl===m.tokenServiceUrl)))&&(m._selfReq={owningTenant:t&&t.owningTenant,selfDfd:this._getPortalSelf(m.tokenServiceUrl.replace(this._rePortalTokenSvc,\"/sharing/rest/portals/self\"),e)}),this._enqueue(e,m,t,a,h)}getResourceName(e){return this._isRESTService(e)?e.replace(this._regexSDirUrl,\"\").replace(this._regexServerType,\"\")||\"\":this._gwUser.test(e)&&e.replace(this._gwUser,\"$1\")||this._gwItem.test(e)&&e.replace(this._gwItem,\"$1\")||this._gwGroup.test(e)&&e.replace(this._gwGroup,\"$1\")||\"\"}generateToken(e,t,s){const n=this._rePortalTokenSvc.test(e.tokenServiceUrl),o=new f(this._appOrigin),a=e.shortLivedTokenValidity;let h,l,c,d,u,p,_,m;t&&(m=this.tokenValidity||a||this.defaultTokenValidity,m>a&&a>0&&(m=a)),s&&(h=s.isAdmin,l=s.serverUrl,c=s.token,p=s.signal,_=s.ssl,e.customParameters=s.customParameters),h?d=e.adminTokenServiceUrl:(d=e.tokenServiceUrl,u=new f(d.toLowerCase()),e.webTierAuth&&null!=s&&s.serverUrl&&!_&&\"http\"===o.scheme&&(g(o.uri,d,!0)||\"https\"===u.scheme&&o.host===u.host&&\"7080\"===o.port&&\"7443\"===u.port)&&(d=d.replace(/^https:/i,\"http:\").replace(/:7443/i,\":7080\")));const v={query:{request:\"getToken\",username:null==t?void 0:t.username,password:null==t?void 0:t.password,serverUrl:l,token:c,expiration:m,referer:h||n?this._appOrigin:null,client:h?\"referer\":null,f:\"json\",...e.customParameters},method:\"post\",authMode:\"anonymous\",useProxy:this._useProxy(e,s),signal:p,...null==s?void 0:s.ioArgs};n||(v.withCredentials=!1);return r(d,v).then((s=>{const r=s.data;if(!r||!r.token)return new i(\"identity-manager:authentication-failed\",\"Unable to generate token\");const n=e.server;return R[n]||(R[n]={}),t&&(R[n][t.username]=t.password),r.validity=m,r}))}isBusy(){return!!this._busy}checkSignInStatus(e){return this.checkAppAccess(e,\"\").then((e=>e.credential))}checkAppAccess(e,t,s){let n=!1;return this.getCredential(e,{prompt:!1}).then((o=>{let a;const h={f:\"json\"};if(\"portal\"===o.scope)if(t&&(this._doPortalSignIn(e)||s&&s.force))a=o.server+\"/sharing/rest/oauth2/validateAppAccess\",h.client_id=t;else{if(!o.token)return{credential:o};a=o.server+\"/sharing/rest\"}else{if(!o.token)return{credential:o};a=o.server+\"/rest/services\"}return o.token&&(h.token=o.token),r(a,{query:h,authMode:\"anonymous\"}).then((e=>{if(!1===e.data.valid)throw new i(\"identity-manager:not-authorized\",`You are currently signed in as: '${o.userId}'.`,e.data);return n=!!e.data.viewOnlyUserTypeApp,{credential:o}})).catch((e=>{if(\"identity-manager:not-authorized\"===e.name)throw e;const t=e.details&&e.details.httpStatus;if(498===t)throw o.destroy(),new i(\"identity-manager:not-authenticated\",\"User is not signed in.\");if(400===t)throw new i(\"identity-manager:invalid-request\");return{credential:o}}))})).then((e=>({credential:e.credential,viewOnly:n})))}setOAuthResponseHash(e){var t;const s=this._oAuthDfd;if(this._oAuthDfd=null,!s||!e)return;clearInterval(this._oAuthIntervalId),null==(t=this._oAuthOnHashHandle)||t.remove(),\"#\"===e.charAt(0)&&(e=e.substring(1));const r=m(e);if(r.error){const e=\"access_denied\"===r.error,t=new i(e?\"identity-manager:user-aborted\":\"identity-manager:authentication-failed\",e?\"ABORTED\":\"OAuth: \"+r.error+\" - \"+r.error_description);s.reject(t)}else{const e=s.sinfo_,t=s.oinfo_,i=t._oAuthCred,n=new j({userId:r.username,server:e.server,token:r.access_token,expires:Date.now()+1e3*Number(r.expires_in),ssl:\"true\"===r.ssl,_oAuthCred:i});t.userId=n.userId,i.storage=r.persist?C:D,i.token=n.token,i.expires=n.expires,i.userId=n.userId,i.ssl=n.ssl,i.save(),s.resolve(n)}}setOAuthRedirectionHandler(e){this._oAuthRedirectFunc=e}setProtocolErrorHandler(e){this._protocolFunc=e}signIn(e,t,s={}){const r=d(),n=()=>{var e,t,s,r,i;null==(e=h)||e.remove(),null==(t=l)||t.remove(),null==(s=c)||s.remove(),null==(r=a)||r.destroy(),null==(i=this.dialog)||i.destroy(),this.dialog=a=h=l=c=null},o=()=>{n(),this._oAuthDfd=null,r.reject(new i(\"identity-manager:user-aborted\",\"ABORTED\"))};s.signal&&u(s.signal,(()=>{o()}));let a=new this.formConstructor;a.resource=this.getResourceName(e),a.server=t.server,this.dialog=new U,this.dialog.content=a,this.dialog.open=!0,this.emit(\"dialog-create\");let h=a.on(\"cancel\",o),l=this.dialog.watch(\"open\",o),c=a.on(\"submit\",(e=>{this.generateToken(t,e,{isAdmin:s.isAdmin,signal:s.signal}).then((i=>{n();const o=new j({userId:e.username,server:t.server,token:i.token,expires:null!=i.expires?Number(i.expires):null,ssl:!!i.ssl,isAdmin:s.isAdmin,validity:i.validity});r.resolve(o)})).catch((e=>{a.error=e,a.signingIn=!1}))}));return r.promise}oAuthSignIn(e,t,s,r){this._oAuthDfd=d();const n=this._oAuthDfd;null!=r&&r.signal&&u(r.signal,(()=>{const e=this._oAuthDfd&&this._oAuthDfd.oAuthWin_;e&&!e.closed?e.close():this.dialog&&h()})),n.resUrl_=e,n.sinfo_=t,n.oinfo_=s;const o=!r||!1!==r.oAuthPopupConfirmation;if(!s.popup||!o)return this._doOAuthSignIn(e,t,s),n.promise;const a=new this.formConstructor;a.oAuthPrompt=!0,a.server=t.server,this.dialog=new U,this.dialog.content=a,this.dialog.open=!0,this.emit(\"dialog-create\");const h=()=>{_(),this._oAuthDfd=null,n.reject(new i(\"identity-manager:user-aborted\",\"ABORTED\"))},l=a.on(\"cancel\",h),c=this.dialog.watch(\"open\",h),p=a.on(\"submit\",(()=>{_(),this._doOAuthSignIn(e,t,s)})),_=()=>{l.remove(),c.remove(),p.remove(),a.destroy(),this.dialog.destroy(),this.dialog=null};return n.promise}destroyCredentials(){if(this.credentials){this.credentials.slice().forEach((e=>{e.destroy()}))}this.emit(\"credentials-destroy\")}enablePostMessageAuth(e=\"https://www.arcgis.com/sharing/rest\"){this._postMessageAuthHandle&&this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=o(window,\"message\",(t=>{var s;if((t.origin===this._appOrigin||t.origin.endsWith(\".arcgis.com\"))&&\"arcgis:auth:requestCredential\"===(null==(s=t.data)?void 0:s.type)){const s=t.source;this.getCredential(e).then((e=>{s.postMessage({type:\"arcgis:auth:credential\",credential:{expires:e.expires,server:e.server,ssl:e.ssl,token:e.token,userId:e.userId}},t.origin)})).catch((e=>{s.postMessage({type:\"arcgis:auth:error\",error:{name:e.name,message:e.message}},t.origin)}))}}))}disablePostMessageAuth(){this._postMessageAuthHandle&&(this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=null)}_getOAuthHash(){let e=window.location.hash;if(e){\"#\"===e.charAt(0)&&(e=e.substring(1));const t=m(e);let s=!1;if(t.access_token&&t.expires_in&&t.state&&t.hasOwnProperty(\"username\"))try{t.state=JSON.parse(t.state),\"object\"==typeof t.state&&t.state.portalUrl&&(this._oAuthHash=t,s=!0)}catch{}else t.error&&t.error_description&&(console.log(\"IdentityManager OAuth Error: \",t.error,\" - \",t.error_description),\"access_denied\"===t.error&&(s=!0));s&&(window.location.hash=\"object\"==typeof t.state&&t.state.hash||\"\")}}_pageShowHandler(e){if(e.persisted&&this.isBusy()&&this._rejectOnPersistedPageShow){const e=new i(\"identity-manager:user-aborted\",\"ABORTED\");this._errbackFunc(e)}}_findCredential(e,t){let s,r,i,n,o=-1;const a=t&&t.token,h=t&&t.resource,l=this._isServerRsrc(e)?\"server\":\"portal\",c=this.credentials.filter((t=>this._hasSameServerInstance(t.server,e)&&t.scope===l));if(e=h||e,c.length)if(1===c.length){if(s=c[0],n=this.findServerInfo(s.server),r=n&&n.owningSystemUrl,i=r&&this.findCredential(r,s.userId),o=this._getIdenticalSvcIdx(e,s),!a)return-1===o&&s.resources.push(e),this._addResource(e,i),s;-1!==o&&(s.resources.splice(o,1),this._removeResource(e,i))}else{let t,s;if(c.some((a=>(s=this._getIdenticalSvcIdx(e,a),-1!==s&&(t=a,n=this.findServerInfo(t.server),r=n&&n.owningSystemUrl,i=r&&this.findCredential(r,t.userId),o=s,!0)))),a)t&&(t.resources.splice(o,1),this._removeResource(e,i));else if(t)return this._addResource(e,i),t}}_findOAuthInfo(e){let t=this.findOAuthInfo(e);if(!t)for(const s of this.oAuthInfos)if(this._isIdProvider(s.portalUrl,e)){t=s;break}return t}_addResource(e,t){t&&-1===this._getIdenticalSvcIdx(e,t)&&t.resources.push(e)}_removeResource(e,t){let s=-1;t&&(s=this._getIdenticalSvcIdx(e,t),s>-1&&t.resources.splice(s,1))}_useProxy(e,t){return t&&t.isAdmin&&!g(e.adminTokenServiceUrl,this._appOrigin)||!this._isPortalDomain(e.tokenServiceUrl)&&\"10.1\"===String(e.currentVersion)&&!g(e.tokenServiceUrl,this._appOrigin)}_getOrigin(e){const t=new f(e);return t.scheme+\"://\"+t.host+(null!=t.port?\":\"+t.port:\"\")}_getServerInstanceRoot(e){const t=e.toLowerCase();let s=t.indexOf(this._agsRest);return-1===s&&this._isAdminResource(e)&&(s=this._agsAdmin.test(e)?e.replace(this._agsAdmin,\"$1\").length:e.search(this._adminSvcs)),-1===s&&(s=t.indexOf(\"/sharing\")),-1===s&&\"/\"===t.substr(-1)&&(s=t.length-1),s>-1?e.substring(0,s):e}_hasSameServerInstance(e,t){return\"/\"===e.substr(-1)&&(e=e.slice(0,-1)),e=e.toLowerCase(),t=this._getServerInstanceRoot(t).toLowerCase(),e=this._normalizeAGOLorgDomain(e),t=this._normalizeAGOLorgDomain(t),(e=e.substr(e.indexOf(\":\")))===(t=t.substr(t.indexOf(\":\")))}_normalizeAGOLorgDomain(e){const t=/^https?:\\/\\/(?:cdn|[a-z\\d-]+\\.maps)\\.arcgis\\.com/i,s=/^https?:\\/\\/(?:cdndev|[a-z\\d-]+\\.mapsdevext)\\.arcgis\\.com/i,r=/^https?:\\/\\/(?:cdnqa|[a-z\\d-]+\\.mapsqa)\\.arcgis\\.com/i;return t.test(e)?e=e.replace(t,\"https://www.arcgis.com\"):s.test(e)?e=e.replace(s,\"https://devext.arcgis.com\"):r.test(e)&&(e=e.replace(r,\"https://qaext.arcgis.com\")),e}_sanitizeUrl(e){const s=(t.request.proxyUrl||\"\").toLowerCase(),r=s?e.toLowerCase().indexOf(s+\"?\"):-1;return-1!==r&&(e=e.substring(r+s.length+1)),e=v(e),_(e).path}_isRESTService(e){return e.indexOf(this._agsRest)>-1}_isAdminResource(e){return this._agsAdmin.test(e)||this._adminSvcs.test(e)}_isServerRsrc(e){return this._isRESTService(e)||this._isAdminResource(e)}_isIdenticalService(e,t){let s;if(this._isRESTService(e)&&this._isRESTService(t)){const r=this._getSuffix(e).toLowerCase(),i=this._getSuffix(t).toLowerCase();if(s=r===i,!s){const e=/(.*)\\/(MapServer|FeatureServer|UtilityNetworkServer).*/gi;s=r.replace(e,\"$1\")===i.replace(e,\"$1\")}}else this._isAdminResource(e)&&this._isAdminResource(t)?s=!0:this._isServerRsrc(e)||this._isServerRsrc(t)||!this._isPortalDomain(e)||(s=!0);return s}_isPortalDomain(e){const s=new f(e.toLowerCase()),r=this._portalConfig;let i=this._gwDomains.some((e=>e.regex.test(s.uri)));return!i&&r&&(i=this._hasSameServerInstance(this._getServerInstanceRoot(r.restBaseUrl),s.uri)),i||t.portalUrl&&(i=g(s,t.portalUrl,!0)),i||(i=this._portals.some((e=>this._hasSameServerInstance(e,s.uri)))),i=i||this._agsPortal.test(s.path),i}_isIdProvider(e,t){let s=-1,r=-1;this._gwDomains.forEach(((i,n)=>{-1===s&&i.regex.test(e)&&(s=n),-1===r&&i.regex.test(t)&&(r=n)}));let i=!1;if(s>-1&&r>-1&&(0===s||4===s?0!==r&&4!==r||(i=!0):1===s?1!==r&&2!==r||(i=!0):2===s?2===r&&(i=!0):3===s&&3===r&&(i=!0)),!i){const s=this.findServerInfo(t),r=s&&s.owningSystemUrl;r&&b(s)&&this._isPortalDomain(r)&&this._isIdProvider(e,r)&&(i=!0)}return i}_getIdenticalSvcIdx(e,t){let s=-1;for(let r=0;r<t.resources.length;r++){const i=t.resources[r];if(this._isIdenticalService(e,i)){s=r;break}}return s}_getSuffix(e){return e.replace(this._regexSDirUrl,\"\").replace(this._regexServerType,\"$1\")}_getTokenSvcUrl(e){let t,s,i;if(this._isRESTService(e)||this._isAdminResource(e)){const i=this._getServerInstanceRoot(e);return t=i+\"/admin/generateToken\",s=r(e=i+\"/rest/info\",{query:{f:\"json\"}}).then((e=>e.data)),{adminUrl:t,promise:s}}if(this._isPortalDomain(e)){let t=\"\";if(this._gwDomains.some((s=>(s.regex.test(e)&&(t=s.tokenServiceUrl),!!t))),t||this._portals.some((s=>(this._hasSameServerInstance(s,e)&&(t=s+this._gwTokenUrl),!!t))),t||(i=e.toLowerCase().indexOf(\"/sharing\"),-1!==i&&(t=e.substring(0,i)+this._gwTokenUrl)),t||(t=this._getOrigin(e)+this._gwTokenUrl),t){const s=new f(e).port;/^http:\\/\\//i.test(e)&&\"7080\"===s&&(t=t.replace(/:7080/i,\":7443\")),t=t.replace(/http:/i,\"https:\")}return t}if(-1!==e.toLowerCase().indexOf(\"premium.arcgisonline.com\"))return\"https://premium.arcgisonline.com/server/tokens\"}_exchangeToken(e,t,s){return r(`${e}/sharing/rest/oauth2/exchangeToken`,{authMode:\"anonymous\",method:\"post\",query:{f:\"json\",client_id:t,token:s}}).then((e=>e.data.token))}_getPlatformSelf(e,t){return r(`${e}/sharing/rest/oauth2/platformSelf`,{authMode:\"anonymous\",headers:{\"X-Esri-Auth-Client-Id\":t,\"X-Esri-Auth-Redirect-Uri\":window.location.href.replace(/#.*$/,\"\")},method:\"post\",query:{f:\"json\"},withCredentials:!0}).then((e=>e.data))}_getPortalSelf(e,t){let s;if(this._gwDomains.some((t=>(t.regex.test(e)&&(s=t.customBaseUrl),!!s))),s)return Promise.resolve({allSSL:!0,currentVersion:\"4.4\",customBaseUrl:s,portalMode:\"multitenant\",supportsOAuth:!0});this._appOrigin.startsWith(\"https:\")?e=e.replace(/^http:/i,\"https:\").replace(/:7080/i,\":7443\"):/^http:/i.test(t)&&(e=e.replace(/^https:/i,\"http:\").replace(/:7443/i,\":7080\"));return r(e,{query:{f:\"json\"},authMode:\"anonymous\",withCredentials:!0}).then((e=>e.data))}_doPortalSignIn(e){const t=this._portalConfig,s=window.location.href,r=this.findServerInfo(e);return!(!t&&!this._isPortalDomain(s)||!(r?r.hasPortal||r.owningSystemUrl&&this._isPortalDomain(r.owningSystemUrl):this._isPortalDomain(e))||!(this._isIdProvider(s,e)||t&&(this._hasSameServerInstance(this._getServerInstanceRoot(t.restBaseUrl),e)||this._isIdProvider(t.restBaseUrl,e))||g(s,e,!0)))}_checkProtocol(e,t,s,r){let n=!0;const o=r?t.adminTokenServiceUrl:t.tokenServiceUrl;if(o.trim().toLowerCase().startsWith(\"https:\")&&!this._appOrigin.startsWith(\"https:\")&&S(o)&&(n=!!this._protocolFunc&&!!this._protocolFunc({resourceUrl:e,serverInfo:t}),!n)){s(new i(\"identity-manager:aborted\",\"Aborted the Sign-In process to avoid sending password over insecure connection.\"))}return n}_enqueue(e,t,s,r,i,n){return r||(r=d()),r.resUrl_=e,r.sinfo_=t,r.options_=s,r.admin_=i,r.refresh_=n,this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(e),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(r)):this._xoReqs.push(r):this._doSignIn(r),r.promise}_doSignIn(e){this._busy=e,this._rejectOnPersistedPageShow=!1;const t=t=>{const s=e.options_&&e.options_.resource,r=e.resUrl_,i=e.refresh_;let n=!1;-1===this.credentials.indexOf(t)&&(i&&-1!==this.credentials.indexOf(i)?(i.userId=t.userId,i.token=t.token,i.expires=t.expires,i.validity=t.validity,i.ssl=t.ssl,i.creationTime=t.creationTime,n=!0,t=i):this.credentials.push(t)),t.resources||(t.resources=[]),t.resources.push(s||r),t.scope=this._isServerRsrc(r)?\"server\":\"portal\",t.emitTokenChange();const o=this._soReqs,a={};this._soReqs=[],o.forEach((e=>{if(!this._isIdenticalService(r,e.resUrl_)){const s=this._getSuffix(e.resUrl_);a[s]||(a[s]=!0,t.resources.push(e.resUrl_))}})),e.resolve(t),o.forEach((e=>{this._hasSameServerInstance(this._getServerInstanceRoot(r),e.resUrl_)?e.resolve(t):this._soReqs.push(e)})),this._busy=e.resUrl_=e.sinfo_=e.refresh_=null,n||this.emit(\"credential-create\",{credential:t}),this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},s=t=>{e.reject(t),this._busy=e.resUrl_=e.sinfo_=e.refresh_=null,this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},r=(r,n,a,h)=>{var l,c;const d=e.sinfo_,p=!e.options_||!1!==e.options_.prompt,_=d.hasPortal&&this._findOAuthInfo(e.resUrl_);let f,m;if(r)t(new j({userId:r,server:d.server,token:a||null,expires:null!=h?Number(h):null,ssl:!!n}));else if(window!==window.parent&&null!=(l=this._appUrlObj.query)&&l[\"arcgis-auth-origin\"]&&null!=(c=this._appUrlObj.query)&&c[\"arcgis-auth-portal\"]&&this._hasSameServerInstance(this._getServerInstanceRoot(this._appUrlObj.query[\"arcgis-auth-portal\"]),e.resUrl_)){var v;window.parent.postMessage({type:\"arcgis:auth:requestCredential\"},this._appUrlObj.query[\"arcgis-auth-origin\"]);const r=o(window,\"message\",(e=>{e.source===window.parent&&e.data&&(\"arcgis:auth:credential\"===e.data.type?(r.remove(),t(new j(e.data.credential))):\"arcgis:auth:error\"===e.data.type&&(r.remove(),s(i.fromJSON(e.data.error))))}));u(null==(v=e.options_)?void 0:v.signal,(()=>{r.remove()}))}else if(_){let r=_._oAuthCred;if(!r){const e=new T(_,C),t=new T(_,D);e.isValid()&&t.isValid()?e.expires>t.expires?(r=e,t.destroy()):(r=t,e.destroy()):r=e.isValid()?e:t,_._oAuthCred=r}if(r.isValid())f=new j({userId:r.userId,server:d.server,token:r.token,expires:r.expires,ssl:r.ssl,_oAuthCred:r}),_.appId!==r.appId&&this._doPortalSignIn(e.resUrl_)?e._pendingDfd=this._exchangeToken(f.server,_.appId,f.token).then((e=>{f.token=e,r.token=e,r.save(),t(f)})).catch((()=>{t(f)})):t(f);else if(this._oAuthHash&&this._hasSameServerInstance(_.portalUrl,this._oAuthHash.state.portalUrl)){const e=this._oAuthHash;f=new j({userId:e.username,server:d.server,token:e.access_token,expires:Date.now()+1e3*Number(e.expires_in),ssl:\"true\"===e.ssl,oAuthState:e.state,_oAuthCred:r}),_.userId=f.userId,r.storage=e.persist?C:D,r.token=f.token,r.expires=f.expires,r.userId=f.userId,r.ssl=f.ssl,r.save(),this._oAuthHash=null,t(f)}else{const r=()=>{p?e._pendingDfd=this.oAuthSignIn(e.resUrl_,d,_,e.options_).then(t,s):(m=new i(\"identity-manager:not-authenticated\",\"User is not signed in.\"),s(m))};this._doPortalSignIn(e.resUrl_)?e._pendingDfd=this._getPlatformSelf(d.server,_.appId).then((({portalUrl:e,token:s,username:i})=>{!e||g(e,this._appOrigin,!0)?(f=new j({server:d.server,userId:i,token:s}),t(f)):r()})).catch(r):r()}}else if(p){if(this._checkProtocol(e.resUrl_,d,s,e.admin_)){let r=e.options_;e.admin_&&(r=r||{},r.isAdmin=!0),e._pendingDfd=this.signIn(e.resUrl_,d,r).then(t,s)}}else m=new i(\"identity-manager:not-authenticated\",\"User is not signed in.\"),s(m)},n=()=>{const r=e.sinfo_,i=r.owningSystemUrl,n=e.options_;let o,a,h,l;if(n&&(o=n.token,a=n.error,h=n.prompt),l=this._findCredential(i,{token:o,resource:e.resUrl_}),!l)for(const e of this.credentials)if(this._isIdProvider(i,e.server)){l=e;break}if(l){const i=this.findCredential(e.resUrl_,l.userId);if(i)t(i);else if(P(r,this._legacyFed)){const e=l.toJSON();e.server=r.server,e.resources=null,t(new j(e))}else{(e._pendingDfd=this.generateToken(this.findServerInfo(l.server),null,{serverUrl:e.resUrl_,token:l.token,signal:e.options_.signal,ssl:l.ssl})).then((s=>{t(new j({userId:l.userId,server:r.server,token:s.token,expires:null!=s.expires?Number(s.expires):null,ssl:!!s.ssl,isAdmin:e.admin_,validity:s.validity}))}),s)}}else{this._busy=null,o&&(e.options_.token=null);(e._pendingDfd=this.getCredential(i.replace(/\\/?$/,\"/sharing\"),{resource:e.resUrl_,owningTenant:r.owningTenant,signal:e.options_.signal,token:o,error:a,prompt:h})).then((()=>{this._enqueue(e.resUrl_,e.sinfo_,e.options_,e,e.admin_)}),(e=>{s(e)}))}};this._errbackFunc=s;const a=e.sinfo_.owningSystemUrl,h=this._isServerRsrc(e.resUrl_),c=e.sinfo_._restInfoPms;c?c.promise.then((t=>{const s=e.sinfo_;if(s._restInfoPms){s.adminTokenServiceUrl=s._restInfoPms.adminUrl,s._restInfoPms=null,s.tokenServiceUrl=l(\"authInfo.tokenServicesUrl\",t)||l(\"authInfo.tokenServiceUrl\",t)||l(\"tokenServiceUrl\",t),s.shortLivedTokenValidity=l(\"authInfo.shortLivedTokenValidity\",t),s.currentVersion=t.currentVersion,s.owningTenant=t.owningTenant;const e=s.owningSystemUrl=t.owningSystemUrl;e&&this._portals.push(e)}h&&s.owningSystemUrl?n():r()}),(()=>{e.sinfo_._restInfoPms=null;const t=new i(\"identity-manager:server-identification-failed\",\"Unknown resource - could not find token service endpoint.\");s(t)})):h&&a?n():e.sinfo_._selfReq?e.sinfo_._selfReq.selfDfd.then((t=>{const s={};let r,i,n,o;return t&&(r=t.user&&t.user.username,s.username=r,s.allSSL=t.allSSL,i=t.supportsOAuth,n=t.currentVersion,\"multitenant\"===t.portalMode&&(o=t.customBaseUrl)),e.sinfo_.webTierAuth=!!r,r&&this.normalizeWebTierAuth?this.generateToken(e.sinfo_,null,{ssl:s.allSSL}).catch((()=>null)).then((e=>(s.portalToken=e&&e.token,s.tokenExpiration=e&&e.expires,s))):!r&&i&&parseFloat(n)>=4.4&&!this._findOAuthInfo(e.resUrl_)?this._generateOAuthInfo({portalUrl:e.sinfo_.server,customBaseUrl:o,owningTenant:e.sinfo_._selfReq.owningTenant}).catch((()=>null)).then((()=>s)):s})).catch((()=>null)).then((t=>{e.sinfo_._selfReq=null,t?r(t.username,t.allSSL,t.portalToken,t.tokenExpiration):r()})):r()}_generateOAuthInfo(e){let t,s,i=e.portalUrl;const n=e.customBaseUrl,o=e.owningTenant,a=!this.defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal;if(a){s=window.location.href;let e=s.indexOf(\"?\");e>-1&&(s=s.slice(0,e)),e=s.search(/\\/(apps|home)\\//),s=e>-1?s.slice(0,e):null}return a&&s?(this._hasTestedIfAppIsOnPortal=!0,t=r(s+\"/sharing/rest\",{query:{f:\"json\"}}).then((()=>{this.defaultOAuthInfo=new x({appId:\"arcgisonline\",popupCallbackUrl:s+\"/home/oauth-callback.html\"})}))):t=Promise.resolve(),t.then((()=>{if(this.defaultOAuthInfo)return i=i.replace(/^http:/i,\"https:\"),r(i+\"/sharing/rest/oauth2/validateRedirectUri\",{query:{accountId:o,client_id:this.defaultOAuthInfo.appId,redirect_uri:w(this.defaultOAuthInfo.popupCallbackUrl),f:\"json\"}}).then((e=>{if(e.data.valid){const t=this.defaultOAuthInfo.clone();e.data.urlKey&&n?t.portalUrl=\"https://\"+e.data.urlKey.toLowerCase()+\".\"+n:t.portalUrl=i,t.popup=window!==window.top||!(g(i,this._appOrigin)||this._gwDomains.some((e=>e.regex.test(i)&&e.regex.test(this._appOrigin)))),this.oAuthInfos.push(t)}}))}))}_doOAuthSignIn(e,t,s){const r={portalUrl:s.portalUrl};!s.popup&&s.preserveUrlHash&&window.location.hash&&(r.hash=window.location.hash);const n={client_id:s.appId,response_type:\"token\",state:JSON.stringify(r),expiration:s.expiration,locale:s.locale,redirect_uri:s.popup?w(s.popupCallbackUrl):window.location.href.replace(/#.*$/,\"\")};s.forceLogin&&(n.force_login=!0),s.forceUserId&&s.userId&&(n.prepopulatedusername=s.userId),!s.popup&&this._doPortalSignIn(e)&&(n.redirectToUserOrgUrl=!0);const h=s.portalUrl.replace(/^http:/i,\"https:\")+\"/sharing/oauth2/authorize\",l=h+\"?\"+I(n);if(s.popup){const e=window.open(l,\"esriJSAPIOAuth\",s.popupWindowFeatures);if(e)e.focus(),this._oAuthDfd.oAuthWin_=e,this._oAuthIntervalId=setInterval((()=>{if(e.closed){clearInterval(this._oAuthIntervalId),this._oAuthOnHashHandle.remove();const e=this._oAuthDfd;if(e){const t=new i(\"identity-manager:user-aborted\",\"ABORTED\");e.reject(t)}}}),500),this._oAuthOnHashHandle=o(a,\"arcgis:auth:hash\",(e=>{this.setOAuthResponseHash(e.detail)}));else{const e=new i(\"identity-manager:popup-blocked\",\"ABORTED\");this._oAuthDfd.reject(e)}}else this._rejectOnPersistedPageShow=!0,this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:n,authorizeUrl:h,resourceUrl:e,serverInfo:t,oAuthInfo:s}):window.location.href=l}}q.prototype.declaredClass=\"esri.identity.IdentityManagerBase\";let j=class extends n.EventedAccessor{constructor(e){super(e),this._oAuthCred=null,this.tokenRefreshBuffer=2,e&&e._oAuthCred&&(this._oAuthCred=e._oAuthCred)}initialize(){this.resources=this.resources||[],null==this.creationTime&&(this.creationTime=Date.now())}refreshToken(){const e=s.findServerInfo(this.server),t=e&&e.owningSystemUrl,r=!!t&&\"server\"===this.scope,i=r&&P(e,s._legacyFed),n=e.webTierAuth,o=n&&s.normalizeWebTierAuth,a=R[this.server],h=a&&a[this.userId];let l,c=this.resources&&this.resources[0],d=r&&s.findServerInfo(t),u={username:this.userId,password:h};if(n&&!o)return;r&&!d&&s.serverInfos.some((e=>(s._isIdProvider(t,e.server)&&(d=e),!!d)));const p=d&&s.findCredential(d.server,this.userId);if(!r||p){if(!i){if(r)l={serverUrl:c,token:p&&p.token,ssl:p&&p.ssl};else if(o)u=null,l={ssl:this.ssl};else{if(!h){let t;return c&&(c=s._sanitizeUrl(c),this._enqueued=1,t=s._enqueue(c,e,null,null,this.isAdmin,this),t.then((()=>{this._enqueued=0,this.refreshServerTokens()})).catch((()=>{this._enqueued=0}))),t}this.isAdmin&&(l={isAdmin:!0})}return s.generateToken(r?d:e,r?null:u,l).then((e=>{this.token=e.token,this.expires=null!=e.expires?Number(e.expires):null,this.creationTime=Date.now(),this.validity=e.validity,this.emitTokenChange(),this.refreshServerTokens()})).catch((()=>{}))}p.refreshToken()}}refreshServerTokens(){\"portal\"===this.scope&&s.credentials.forEach((e=>{const t=s.findServerInfo(e.server),r=t&&t.owningSystemUrl;e!==this&&e.userId===this.userId&&r&&\"server\"===e.scope&&(s._hasSameServerInstance(this.server,r)||s._isIdProvider(r,this.server))&&(P(t,s._legacyFed)?(e.token=this.token,e.expires=this.expires,e.creationTime=this.creationTime,e.validity=this.validity,e.emitTokenChange()):e.refreshToken())}))}emitTokenChange(e){clearTimeout(this._refreshTimer);const t=this.server&&s.findServerInfo(this.server),r=t&&t.owningSystemUrl,i=r&&s.findServerInfo(r);!1===e||r&&\"portal\"!==this.scope&&(!i||!i.webTierAuth||s.normalizeWebTierAuth)||null==this.expires&&null==this.validity||this._startRefreshTimer(),this.emit(\"token-change\")}destroy(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null,this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);const e=s.credentials.indexOf(this);e>-1&&s.credentials.splice(e,1),this.emitTokenChange(),this.emit(\"destroy\")}toJSON(){const e=h({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),t=this.resources;return t&&t.length>0&&(e.resources=t.slice()),e}_startRefreshTimer(){clearTimeout(this._refreshTimer);const e=6e4*this.tokenRefreshBuffer,t=2**31-1;let s=(this.validity?this.creationTime+6e4*this.validity:this.expires)-Date.now();s<0?s=0:s>t&&(s=t),this._refreshTimer=setTimeout(this.refreshToken.bind(this),s>e?s-e:s)}};e([k()],j.prototype,\"creationTime\",void 0),e([k()],j.prototype,\"expires\",void 0),e([k()],j.prototype,\"isAdmin\",void 0),e([k()],j.prototype,\"oAuthState\",void 0),e([k()],j.prototype,\"resources\",void 0),e([k()],j.prototype,\"scope\",void 0),e([k()],j.prototype,\"server\",void 0),e([k()],j.prototype,\"ssl\",void 0),e([k()],j.prototype,\"token\",void 0),e([k()],j.prototype,\"tokenRefreshBuffer\",void 0),e([k()],j.prototype,\"userId\",void 0),e([k()],j.prototype,\"validity\",void 0),j=e([A(\"esri.identity.Credential\")],j);export{j as Credential,q as IdentityManagerBase};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{setId as e}from\"../kernel.js\";import{IdentityManagerBase as t}from\"./IdentityManagerBase.js\";class r extends t{}r.prototype.declaredClass=\"esri.identity.IdentityManager\";const s=new r;e(s);export default s;\n"],"sourceRoot":""}